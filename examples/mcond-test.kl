#lang "prelude.kl"

(import (shift "prelude.kl" 1))
(import (shift "mcond.kl" 1))

(define-macros
  ([test
    (lambda (stx)
      (syntax-case stx
        [(list (_ id))
         (mcond
          [(free-identifier=? id 'if) (pure '(the Integer 1))]
          [(free-identifier=? id 'else) (pure '(the Integer 2))]
          [(free-identifier=? id 'lambda) (pure '(the Integer 3))]
          [(pure (true)) (pure '(the Integer 4))])]))]))

(example (test if))
(example (test else))
(example (test lambda))
(example (test define))
(example (test argh))
